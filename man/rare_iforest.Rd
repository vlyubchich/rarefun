% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rare_iforest.R
\name{rare_iforest}
\alias{rare_iforest}
\title{Detect Rare Events Using Isolation Forest}
\usage{
rare_iforest(
  x,
  ndim = 1,
  ntrees = 500,
  missing_action = "fail",
  scoring_metric = "adj_depth",
  penalize_range = TRUE,
  nthreads = parallel::detectCores() - 1,
  threshold = 0.5,
  sample_size = NULL,
  ...
)
}
\arguments{
\item{x}{A numeric matrix or data frame with no missing values (unless
`missing_action` is set to handle them). Rows are observations, and columns are features.}

\item{ndim}{Integer, number of dimensions to split at each node (default: 1).}

\item{ntrees}{Integer, number of trees in the forest (default: 500).}

\item{missing_action}{Character, how to handle missing values: 'fail', 'impute', or 'auto' (default: 'fail').}

\item{scoring_metric}{Character, scoring method for anomalies: 'depth', 'adj_depth', or 'density' (default: 'adj_depth').}

\item{penalize_range}{Logical, whether to penalize features with smaller ranges (default: TRUE).}

\item{nthreads}{Integer, number of threads for parallel processing (default: parallel::detectCores() - 1).}

\item{threshold}{Numeric, anomaly score threshold for classifying rare events (default: 0.5).}

\item{sample_size}{Integer or fraction, number or proportion of rows to sample for training (default: NULL, uses all rows).}

\item{...}{Additional arguments passed to `isotree::isolation.forest`.}
}
\value{
A list containing:
  \itemize{
    \item \code{scores}: Numeric vector of anomaly scores for each observation.
    \item \code{is_anomaly}: Logical vector indicating whether each observation is an anomaly (score > threshold).
    \item \code{model}: The fitted `isotree` isolation forest model.
  }
}
\description{
This function applies an isolation forest algorithm to detect rare events (anomalies)
in a dataset using the `isotree` package. It fits a model, computes anomaly scores,
and classifies observations based on a specified threshold.
}
\examples{
\dontrun{
set.seed(123)
data <- matrix(rnorm(1000), nrow = 500)
data[1:5, ] <- data[1:5, ] + 10  # Add some outliers
result <- rare_iforest(data, ntrees = 100, threshold = 0.7)
table(result$is_anomaly)
plot(data, col = ifelse(result$is_anomaly, "red", "blue"), pch = 19)

result <- rare_iforest(iris[, 1:4], threshold = 0.5)
table(result$is_anomaly)

result <- rare_iforest(swiss, threshold = 0.5)
table(result$is_anomaly)
}
}
